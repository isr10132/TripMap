<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Calendar</title>
	<!-- Fullcalendar css -->
	<link rel='stylesheet' href='fullcalendar/fullcalendar.css' />
	<!-- Bootstrap css -->
	<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
	<style type="text/css">
		.calendar-area {
			margin: 50px;
			width: 50%;
		}
		.red {
			background-color: red;
		}
		.blue {
			background-color: blue;
		}
		.green {
			background-color: green;
		}
		.external-event:hover {
		    box-shadow: inset 0 0 90px rgba(0, 0, 0, 0.2);
		}
	</style>
	<!-- Fullcalendar js -->
	<script src="jquery-3.3.1.min.js" type="text/javascript"></script>
	<!-- <script src='fullcalendar/lib/jquery.min.js'></script> -->
	<script src='fullcalendar/lib/moment.min.js'></script>
	<script src="http://code.jquery.com/ui/1.11.1/jquery-ui.min.js"
		type="text/javascript"></script>
	<script src='fullcalendar/fullcalendar.js'></script>
	<!-- Bootstrap js -->
	<script src="bootstrap/js/bootstrap.min.js" type="text/javascript"></script>

	<script>
		// 記得用檔案引入js	
		$(function(){

			// 外部事件可拖拉
			$('#selectedEvent').draggable({
		        zIndex: 1070,
		        revert: true, // will cause the event to go back to its
		        revertDuration: 0  //  original position after the drag
	   		});

	   		// 取得所有 fc 上的 event
	   		$('#get-events-btn').click(function(){
	   			var eventsArray = $('#calendar').fullCalendar('clientEvents');
	   			for (var i = 0; i < eventsArray.length; i++)
	   			{
	   				console.log(eventsArray[i].start.format());
	   			}
	   		});

	   		// 更改 selected event 顏色
	   		$('.color-btn').click(function(){
	   			var tmpColor = $(this).css('background-color');
	   			$('#selectedEvent').css({'background-color': tmpColor, 'border-color': tmpColor});
	   		})

	   		// 使用者輸入完後 按下添加
	   		$('#add-new-event').click(addEvent);

	   		// 使用者輸入完後 按下 Enter 可視為執行添加
			$("#new-event").on('keyup', function (e) {
			    if (e.keyCode == 13) {
			        addEvent();
			    }
			});

			// 將使用者輸入的資訊弄成 event 並顯示在 selected event
			function addEvent(){
	   			$('#selectedEvent').text($('#new-event').val());
	   			$('#new-event').val('');
	   		}

			$('#calendar').fullCalendar({
				// 視圖的擺放
		        header: {
		          left: 'prev,next today',
		          center:  'title',
		          right: 'month,agendaWeek,agendaDay'
		        },
		        // 按鈕的文字
		        buttonText: {
		          today: '今天',
		          month: '月',
		          week: '周',
		          day: '天'
		        },
		        // 日期格式
		        timeFormat: 'hh:mm a',
		        // 行事曆的操作
		        editable: true,
		        droppable: true,
		        selectable: true,
		        selectHelper: true,
		        drop: function(data, allDay) {
					var event = {
						title: $(this).text(),
			            backgroundColor: $(this).css("background-color"),
			            borderColor: $(this).css("border-color"),
			            start: data.toISOString(),
			            allDay: !data.hasTime()
					}
					$('#calendar').fullCalendar('renderEvent', event, true);
		        }
		        
		    }); // end fullCalendar
		})

		function addEvent(data)
		{
			
		}

	</script>
</head>
<body>
	<div class="input-group">
		<input id="new-event" type="text" class="form-control"
			placeholder="Event Title">
		<div class="input-group-btn">
			<button id="add-new-event" type="button"
				class="btn btn-primary btn-flat">Add</button>
		</div>
		<!-- /btn-group -->
	</div>

	<div class="box-body">
		<!-- the events -->
		<div class='external-event' id='selectedEvent' style='background-color:#00c0ef;border-color:#00c0ef;color:white;position: relative;'>選擇事件...
		</div>
		<div>
			<button class="red btn color-btn">Red</button>
			<button class="green btn color-btn">Green</button>
			<button class="blue btn color-btn">Blue</button>
		</div>
	</div>

	<div class="calendar-area">
		<div id="calendar"></div>
	</div>
	<div>
		<button id="get-events-btn" class="btn">Get All EventObjects</button>
	</div>
</body>

</html>